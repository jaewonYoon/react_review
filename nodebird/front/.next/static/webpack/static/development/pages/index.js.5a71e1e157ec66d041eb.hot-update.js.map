{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.5a71e1e157ec66d041eb.hot-update.js","sources":["webpack:///./components/PostCard.jsx","webpack:///./components/PostForm.jsx","webpack:///./pages/index.js","webpack:///./reducers/post.js"],"sourcesContent":["import React,{useState, useCallback, useEffect} from 'react';\r\nimport {useSelector,useDispatch} from 'react-redux';\r\nimport {Card, Icon, Button, Avatar, Input,List, Comment,Form} from 'antd';\r\nimport PropTypes from 'prop-types';\r\nimport { ADD_COMMENT_REQUEST } from '../reducers/post';\r\nconst PostCard =({post}) => {\r\n    const dispatch = useDispatch();\r\n    const [commentFormOpened, setCommentFormOpened] = useState(false);\r\n    const [commentText, setCommentText] = useState('');\r\n    const {me} = useSelector(state => state.user);\r\n    const {commentAdded, isAddingComment} = useSelector(state => state.post); \r\n    const onToggleComment = useCallback(() => {\r\n        setCommentFormOpened(prev => !prev);\r\n    },[]);\r\n    const onSubmitComment = useCallback((e) => {\r\n        e.preventDefault();\r\n        if(!me){\r\n            return alert('로그인이 필요합니다.'); \r\n        }\r\n        dispatch({\r\n            type: ADD_COMMENT_REQUEST,\r\n            data:{\r\n                postId: post.id \r\n            }\r\n        });\r\n    },[me&&me.id]);\r\n\r\n    useEffect( () => {\r\n        setCommentText(''); \r\n    },[commentAdded ===true])\r\n    const onChangeCommentText = useCallback((e) => {\r\n        setCommentText(e.target.value); \r\n    }, []);\r\n    return(\r\n        <div>\r\n        <Card \r\n            key={+post.createdAt}\r\n            cover={post.img && <img alt=\"example\" src={post.img} />}\r\n            actions={[\r\n                <Icon type=\"retweet\" key=\"retweet\" />,\r\n                <Icon type=\"heart\" key=\"heart\" />,\r\n                <Icon type=\"message\" key=\"message\" onClick={onToggleComment}/>,\r\n                <Icon type=\"ellipsis\" key=\"ellipsis\" />\r\n            ]}\r\n            extra={<Button>팔로우</Button>}\r\n        >\r\n            <Card.Meta\r\n                avatar={<Avatar>{post.User.nickname[0]}</Avatar>}\r\n                title={post.User.nickname}\r\n                description={post.content}\r\n            />\r\n        </Card>\r\n            {commentFormOpened && (\r\n                <>\r\n                    <Form onSubmit = {onSubmitComment}>\r\n                        <Form.Item>\r\n                            <Input.TextArea rows={4} value = {commentText} onChange={onChangeCommentText} />\r\n                        </Form.Item>\r\n                        <Button type=\"primary\" htmlType=\"submit\" loading={isAddingComment}>삐약</Button>\r\n                    </Form>\r\n                    <List\r\n                        header={`${post.Comments ? post.Comments.length: 0}댓글`}\r\n                        itemLayout=\"horizontal\"\r\n                        dataSource={post.Comments || []}\r\n                        renderItem= {item => (\r\n                            <li>\r\n                                <Comment\r\n                                    author={item.User.nickname}\r\n                                    avatar={<Avatar>{item.User.nickname[0]}</Avatar>}\r\n                                    content={item.content}\r\n                                />\r\n                            </li>\r\n                        )}\r\n                    />\r\n                </>\r\n            )}\r\n        </div>\r\n    )\r\n}\r\n\r\nPostCard.propTypes ={\r\n    post: PropTypes.shape({\r\n        User: PropTypes.object,\r\n        content:PropTypes.string,\r\n        img:PropTypes.string,\r\n        createdAt:PropTypes.object\r\n    })\r\n}\r\n\r\nexport default PostCard;","import React,{useCallback,useState,useEffect} from 'react';\r\nimport {Form, Input, Button} from 'antd';\r\nimport {useSelector, useDispatch} from 'react-redux';\r\nimport { ADD_POST_REQUEST } from '../reducers/post';\r\nconst PostForm = () => {\r\n    const dispatch = useDispatch();\r\n    const [text,setText] = useState('');\r\n    const {imagePaths, isAddingPost, postAdded} = useSelector( (state) => state.post); \r\n    \r\n    useEffect( () => {\r\n        setText('');\r\n    },[postAdded===true]);\r\n    const onSubmitForm = useCallback((e) => {\r\n        e.preventDefault(); \r\n        dispatch({\r\n            type: ADD_POST_REQUEST,\r\n            data: {\r\n                text,\r\n            }\r\n        })\r\n    },[]);\r\n    const onChangeText = useCallback((e) => {\r\n        setText(e.target.value);\r\n    });\r\n    return (\r\n    <Form style={{margin: '10px 0 20px'}} encType=\"multipart/form-data\" onSubmit={onSubmitForm}>\r\n                    <Input.TextArea maxLength={140} placeholder=\"어떤 신기한 일이 있었나요?\" onChange = {onChangeText}/>    \r\n                    <div>\r\n                        <input type=\"file\" multiple hidden />\r\n                        <Button> 이미지 업로드</Button>\r\n                        <Button type=\"primary\" style={{float:'right'}} htmlType=\"submit\" loading={isAddingPost}>짹쨱</Button>\r\n                    </div>\r\n                    <div>\r\n                        {imagePaths.map( (v,i) => {\r\n                            return (\r\n                                <div key={v} style={{display: 'inline-block'}}>\r\n                                    <img src={'http://localhost:3000/' + v} style={{width:'200px'}} alt={v} />\r\n                                    <div>\r\n                                        <Button>제거</Button>\r\n                                    </div>\r\n                                </div>\r\n                            )\r\n                        })}\r\n                    </div> \r\n                </Form>\r\n    )\r\n}\r\n\r\nexport default PostForm;","import React,{useState,useEffect} from 'react';\r\nimport PostForm from '../components/PostForm'; \r\nimport PostCard from '../components/PostCard';\r\nimport {useDispatch, useSelector, connect} from'react-redux'; \r\nimport {loginAction, logoutAction} from '../reducers/user';\r\n// 메인화면 루트 파일 next는 import react를 하지 않아도 된다.  \r\n\r\nconst Home = ({}) => {\r\n    const {isLoggedIn,me} = useSelector( (state) =>state.user);\r\n    const {mainPosts} = useSelector( (state) => state.post);\r\n    // const {isLoggedIn, user} = useSelector(state => state.user);\r\n    //useEffect할 때 [] 안에 아무것도 없다면 componentDidMount와 같음 \r\n    const dispatch = useDispatch();\r\n    useEffect( () => {\r\n        \r\n        // 첫번째 렌더링 될 때 이 dispatch도 함께 되는 것 \r\n        // dispatch(loginAction);\r\n    },[]);\r\n    return(\r\n        <div>\r\n            {isLoggedIn ? <div>로그인 했습니다: {me.nickname}</div> : <div>로그아웃 했습니다.</div>}\r\n            {isLoggedIn && <PostForm />}\r\n            {mainPosts.map( (c) => {\r\n                return(\r\n                    <PostCard key={c} post={c}/>\r\n                )\r\n            })}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Home;\r\n","const initialState= {\r\n    mainPosts: [{\r\n        id:1, \r\n        User:{\r\n            id: 1,\r\n            nickname: 'Jay',\r\n        },\r\n        content: '첫 번째 게시글',\r\n        img: 'https://images.unsplash.com/photo-1575550590262-4ad1d8738faa?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=634&q=80',\r\n        Comments: []\r\n    }],\r\n    imagePaths: [], // 미리보기 이미지 경로\r\n    addPostErrorReason: false, //포스트 업로드 실패  \r\n    isAddingPost: false, //포스트 업로드 중\r\n    postAdded: false,\r\n    isAddingComment: false, \r\n    addCommentErrorReason: '', \r\n    commentAdded: false\r\n}\r\n\r\nconst dummyPost = {\r\n    id: 2, \r\n    User: {\r\n       id: 1,\r\n       nickname: 'jay',\r\n    },\r\n    content: '나는 더미입니다.'\r\n}\r\nconst dummyComment = {\r\n    User: {\r\n        id: 1,\r\n        nickname:'Jay' \r\n    },\r\n    createdAt: new Date(),\r\n    content: '더미 댓글입니다.'\r\n}\r\nexport const ADD_POST_REQUEST = 'ADD_POST_REQUEST';\r\nexport const ADD_POST_SUCCESS = 'ADD_POST_SUCCESS';\r\nexport const ADD_POST_FAILURE = 'ADD_POST_FAILURE';\r\n\r\nexport const LOAD_HASHTAG_POSTS_REQUEST= 'LOAD_HASHTAG_POSTS_REQUEST';\r\nexport const LOAD_HASHTAG_POSTS_SUCCESS= 'LOAD_HASHTAG_POSTS_SUCCESS';\r\nexport const LOAD_HASHTAG_POSTS_FAILURE= 'LOAD_HASHTAG_POSTS_FAILURE';\r\n\r\nexport const LOAD_USER_POSTS_REQUEST= 'LOAD_USER_POSTS_REQUEST';\r\nexport const LOAD_USER_POSTS_SUCCESS= 'LOAD_USER_POSTS_SUCCESS';\r\nexport const LOAD_USER_POSTS_FAILURE= 'LOAD_USER_POSTS_FAILURE';\r\n\r\nexport const UPLOAD_IMAGES_REQUEST= 'UPLOAD_IMAGES_REQUEST';\r\nexport const UPLOAD_IMAGES_SUCCESS= 'UPLOAD_IMAGES_SUCCESS';\r\nexport const UPLOAD_IMAGES_FAILURE= 'UPLOAD_IMAGES_FAILURE';\r\n\r\nexport const REMOVE_IMAGE = 'REMOVE_IMAGE';\r\n\r\nexport const LIKE_POST_REQUEST = 'LIKE_POST_REQUEST';\r\nexport const LIKE_POST_SUCCESS = 'LIKE_POST_SUCCESS';\r\nexport const LIKE_POST_FAILURE = 'LIKE_POST_FAILURE';\r\n\r\nexport const UNLIKE_POST_REQUEST = 'UNLIKE_POST_REQUEST';\r\nexport const UNLIKE_POST_SUCCESS = 'UNLIKE_POST_SUCCESS';\r\nexport const UNLIKE_POST_FAILURE = 'UNLIKE_POST_FAILURE';\r\n\r\nexport const LOAD_COMMENTS_REQUEST = 'LOAD_COMMENTS_REQUEST';\r\nexport const LOAD_COMMENTS_SUCCESS = 'LOAD_COMMENTS_SUCCESS';\r\nexport const LOAD_COMMENTS_FAILURE = 'LOAD_COMMENTS_FAILURE';\r\n\r\nexport const ADD_COMMENT_REQUEST = 'ADD_COMMENT_REQUEST';\r\nexport const ADD_COMMENT_SUCCESS = 'ADD_COMMENT_SUCCESS';\r\nexport const ADD_COMMENT_FAILURE = 'ADD_COMMENT_FAILURE';\r\n\r\nexport const RETWEET_REQUEST = 'RETWEET_REQUEST';\r\nexport const RETWEET_SUCCESS = 'RETWEET_SUCCESS';\r\nexport const RETWEET_FAILURE = 'RETWEET_FAILURE';\r\n\r\nexport const REMOVE_POST_REQUEST = 'REMOVE_POST_REQUEST';\r\nexport const REMOVE_POST_SUCCESS = 'REMOVE_POST_SUCCESS';\r\nexport const REMOVE_POST_FAILURE = 'REMOVE_POST_FAILURE';\r\n\r\nconst ADD_DUMMY = 'ADD_DUMMY';\r\n\r\nexport const addPost = {\r\n}\r\n\r\nconst reducer = (state=initialState, action) => {\r\n    switch(action.type){\r\n        case ADD_POST_REQUEST: {\r\n            return {\r\n                ...state, \r\n                isAddingPost:true,\r\n                addPostErrorReason: '',\r\n                postAdded: false \r\n            };\r\n        }\r\n        case ADD_POST_SUCCESS: {\r\n            return {\r\n                ...state,\r\n                isAddingPost: false,\r\n                mainPosts: [dummyPost, ...state.mainPosts],\r\n                postAdded: true \r\n            }\r\n        }\r\n        case ADD_POST_FAILURE: {\r\n            return {\r\n                ...state,\r\n                isAddingPost: false,\r\n                addPostErrorReason: action.error,\r\n            };\r\n        }\r\n        case ADD_COMMENT_REQUEST: {\r\n            return {\r\n                ...state,\r\n                isAddingComment: true,\r\n                addCommentErrorReason: '',\r\n                commentAdded: false, \r\n            }\r\n        }\r\n        case ADD_COMMENT_SUCCESS: {\r\n            const postIndex = state.mainPosts.findIndex( v=> v.id ===action.data.postId);\r\n            const post = state.mainPosts[postIndex];\r\n            const Comments = [...post.Comments, dummyComment];\r\n            const mainPosts = [...state.mainPosts];\r\n            mainPosts[postIndex] = {...post,Comments}; \r\n            return {\r\n                ...state,\r\n                isAddingComment: false,\r\n                mainPosts,\r\n                postAdded: true\r\n            }\r\n        }\r\n        case ADD_COMMENT_FAILURE: {\r\n            return {\r\n                ...state,\r\n                isAddingComment: false,\r\n                addCommentErrorReason: action.error \r\n            }\r\n        }\r\n        default: {\r\n            return {\r\n                ...state \r\n            }\r\n        }\r\n    }\r\n}   \r\n\r\nexport default reducer; "],"mappings":"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","sourceRoot":""}